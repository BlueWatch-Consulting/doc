Amalgame: a SKOS vocabulary alignment tool http://semanticweb.cs.vu.nl/amalgame/

==Setup==

===Register namespaces===

On the prolog command line:

  rdf_register_prefix('zbwext', 'http://zbw.eu/namespaces/zbw-extensions/').
  rdf_register_prefix('sdmx-subject', 'http://purl.org/linked-data/sdmx/2009/subject#').

===Add missing skos:inScheme properties===

Amalgame needs them to know which resources are part of a scheme.
 
  
  /* add top concepts to scheme */
  findall(T,
    rdf('sdmx-subject':subjectMatterDomain, skos:hasTopConcept, T),
    Triples),
  forall(member(T, Triples),
    rdf_assert(T, skos:inScheme, 'sdmx-subject':subjectMatterDomain)
  ).
  
  /* add concepts to scheme, which have broader concepts in scheme */
  /* (not transitive - repeat!) */
  findall(N-B,
    ( rdf(N,skos:broader,B),
      rdf(B,skos:inScheme,'sdmx-subject':subjectMatterDomain)
    ),
    Triples
  ),
  forall(member(N-B, Triples),
    rdf_assert(N,skos:inScheme,'sdmx-subject':subjectMatterDomain)
  ).  

==Installation on Redhat/CentOS==

Amalgame is based on ClioPatria, which is requires the latest version of SWI-Prolog.

===Install SWI Prolog===

====SWI-Prolog 6.6.5 on CentOS 6.5====

1) Install dependencies as indicated in http://www.swi-prolog.org/build/Redhat.html, '''plus'''
  gcc 
  graphviz # (optional, for graphics)
  redhat-lsb # (optional, for system startup script)

2) Follow http://www.swi-prolog.org/build/unix.html

Set in build

  PREFIX=/usr/local

====CentOS 5.x====

Did not work - see http://www.swi-prolog.org/bugzilla/show_bug.cgi?id=76 (for CentOS 5.10 and SWI-Prolog 6.6.5, too).

===Install ClioPatria and Amalgame===

  cd /opt
  git clone git://www.swi-prolog.org/home/pl/git/ClioPatria.git
  ./configure

  ./run.pl
    ?- cpack_install('amalgame').

Invoke http://localhost:3020 and set password for 'admin'.

===Set up Apache reverse proxy===

Add to <tt>ClioPartria/settings.db</tt>:

  %       Prefix for all locations of this server
  setting(http:prefix, '/amalgame').

Create <tt>/etc/httpd/conf.d/amalgame.conf</tt>

  ProxyPass /amalgame http://127.0.0.1:3020/amalgame
  ProxyPassReverse /amalgame http://127.0.0.1:3020/amalgame

===Startup script===

Cliopatria <tt>debian-init-script</tt> requires the functions <tt>log_daemon_msg</tt> and <tt>log_end_msg</tt>, which are not available in RH/Centos 6.5 lsb packages (and not defined in [http://refspecs.linuxbase.org/LSB_4.1.0/LSB-Core-generic/LSB-Core-generic/iniscrptfunc.html LSB 4.1]).

Workarround: Replace with <tt>log_success_msg</tt> and <tt>log_failure_msg</tt>.

==Maintenance==

===Upgrade a package===

  ?- cpack_upgrade(skos_browser).
  ?- make.

==Weblinks==

* [http://vimeo.com/23420503 Video tutorial]
* [https://github.com/jrvosse/amalgame/blob/master/README.md Overview, terminology]
* [https://github.com/jrvosse/amalgame Code]
